"use strict";(self.webpackChunkparticle_auth_cra=self.webpackChunkparticle_auth_cra||[]).push([[1531],{19104:(e,a,t)=>{t.d(a,{a:()=>l});var n=t(46686),s=t(65043),l=()=>{let{authCoreModal:e}=(0,n.pa)(),a=(0,s.useMemo)((()=>e.rootModalContainer),[e]),t=(0,s.useCallback)((function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";var n;let s=document.createElement("div");s.className="ant-message-notice";let l=document.createElement("div");l.className="ant-message-notice-content";let r=document.createElement("div");r.className="ant-message-custom-content";let i=document.createElement("span");i.setAttribute("role","img"),i.setAttribute("aria-label","check-circle"),i.className="anticon anticon-check-circle";let c=document.createElement("svg");"success"===e?(r.className+=" ant-message-success",c.innerHTML='<svg viewBox="64 64 896 896" focusable="false" data-icon="check-circle" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm193.5 301.7l-210.6 292a31.8 31.8 0 01-51.7 0L318.5 484.9c-3.8-5.3 0-12.7 6.5-12.7h46.9c10.2 0 19.9 4.9 25.9 13.3l71.2 98.8 157.2-218c6-8.3 15.6-13.3 25.9-13.3H699c6.5 0 10.3 7.4 6.5 12.7z"></path></svg>'):"error"===e?(r.className+=" ant-message-error",c.innerHTML='<svg viewBox="64 64 896 896" focusable="false" data-icon="close-circle" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm165.4 618.2l-66-.3L512 563.4l-99.3 118.4-66.1.3c-4.4 0-8-3.5-8-8 0-1.9.7-3.7 1.9-5.2l130.1-155L340.5 359a8.32 8.32 0 01-1.9-5.2c0-4.4 3.6-8 8-8l66.1.3L512 464.6l99.3-118.4 66-.3c4.4 0 8 3.5 8 8 0 1.9-.7 3.7-1.9 5.2L553.5 514l130 155c1.2 1.5 1.9 3.3 1.9 5.2 0 4.4-3.6 8-8 8z"></path></svg>'):"info"===e?(r.className+=" ant-message-info",c.innerHTML='<svg viewBox="64 64 896 896" focusable="false" data-icon="info-circle" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm32 664c0 4.4-3.6 8-8 8h-48c-4.4 0-8-3.6-8-8V456c0-4.4 3.6-8 8-8h48c4.4 0 8 3.6 8 8v272zm-32-344a48.01 48.01 0 010-96 48.01 48.01 0 010 96z"></path></svg>'):"warning"===e&&(r.className+=" ant-message-warning",c.innerHTML='<svg viewBox="64 64 896 896" focusable="false" data-icon="exclamation-circle" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm-32 232c0-4.4 3.6-8 8-8h48c4.4 0 8 3.6 8 8v272c0 4.4-3.6 8-8 8h-48c-4.4 0-8-3.6-8-8V296zm32 440a48.01 48.01 0 010-96 48.01 48.01 0 010 96z"></path></svg>');let o=document.createElement("span");return o.textContent=t,i.appendChild(c),r.appendChild(i),r.appendChild(o),l.appendChild(r),s.appendChild(l),null==(n=null==a?void 0:a.querySelector(".ant-message"))||n.appendChild(s),s}),[a]),l=(0,s.useCallback)((e=>{let n=t("error",e);setTimeout((()=>{var e;null==(e=null==a?void 0:a.querySelector(".ant-message"))||e.removeChild(n)}),2e3)}),[t]),r=(0,s.useCallback)((e=>{let n=t("info",e);setTimeout((()=>{var e;null==(e=null==a?void 0:a.querySelector(".ant-message"))||e.removeChild(n)}),2e3)}),[t]),i=(0,s.useCallback)((e=>{let n=t("success",e);setTimeout((()=>{var e;null==(e=null==a?void 0:a.querySelector(".ant-message"))||e.removeChild(n)}),2e3)}),[t]),c=(0,s.useCallback)((e=>{let n=t("warning",e);setTimeout((()=>{var e;null==(e=null==a?void 0:a.querySelector(".ant-message"))||e.removeChild(n)}),2e3)}),[t]);return(0,s.useEffect)((()=>{if(a){if(a.querySelector(".ant-message"))return;let e=document.createElement("div");e.className="ant-message",e.style.zIndex="999999999999999999999999",a.appendChild(e)}}),[a]),{error:l,info:r,success:i,warning:c}}},61531:(e,a,t)=>{t.r(a),t.d(a,{default:()=>E});var n=t(34912),s=t(41524),l=t(19104),r=t(43290),i=t(46686),c=t(35478),o=t(25001),m=t(68366),d=t(24539),u=t(89421),g=t(40462),v=t(65043),h=t(61476),p=t(74117),f={async findAssociatedTokenAddress(e,a){let{PublicKey:n}=await t.e(713).then(t.bind(t,60713)),s=new n("TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA");return n.findProgramAddressSync([new n(e).toBuffer(),s.toBuffer(),new n(a).toBuffer()],new n("ATokenGPvbdGVxr1b2hvZbsiqW5xWH25efTNsLJA8knL"))[0]}};var E=function(e){let{method:a,param:t,chainId:E,loginAuthorizationSign:C}=e,{t:N}=(0,p.Bd)(),y=(0,i.ra)(),{setPaymentVerify:w,userInfo:S,setPaymentPassword:T}=(0,i.oa)(),{events:_}=(0,i.ta)(),{modalOptions:k}=(0,i.sa)(),{authCoreModal:A}=(0,i.pa)(),{errorHandle:b}=(0,s.a)(),[z,M]=(0,v.useState)(!1),I=(0,l.a)(),[P,L]=(0,v.useState)(),[q,Z]=(0,v.useState)(),[B,x]=(0,v.useState)(),[Q,O]=(0,v.useState)(""),[G,U]=(0,v.useState)(""),{hasSetPaymentPassword:F,showSetPaymentPasswordOrConfirm:D}=(0,n.b)(),H=(0,v.useMemo)((()=>({id:E||o.pQ.solana.chainId,name:"Solana"})),[]),K=(0,v.useMemo)((()=>{let e=o.pQ.solana.selectedAddress;return(0,i.N)(e)}),[]);(0,v.useEffect)((()=>{(0,o.P9)().catch((e=>{})),(0,o.O)()&&y("account/master-password/verify")}),[y]);let R=(e,a)=>{_.emit("signResponse",{result:e,error:a})};async function V(e,a){if(!a)return[];let t=await Promise.all(a.map(e));return a.filter(((e,a)=>t[a]))}let W=async()=>{var e,t;!a||((0,o.qD)({record_type:c.ee.PAGE_SIGN_CONFIRM_BUTTON_CLICK}),null!=(e=null==S?void 0:S.security_account)&&e.has_set_payment_password?w({visible:!0,onVerifyCompleted:J}):a===o.zZ.signAndSendTransaction||a===o.zZ.signTransaction||a===o.zZ.signAllTransactions||3===(null==(t=null==k?void 0:k.promptSettingConfig)?void 0:t.promptPaymentPasswordSettingWhenSign)?D(J):J())},J=async()=>{var e;if(!a)return;let n;M(!0);try{if(a===o.zZ.signMessage){let{signature:e}=await o.pQ.solana.signMessage(t);n=e}else if(a===o.zZ.signAndSendTransaction){let{signature:e}=await o.pQ.solana.signAndSendTransaction(t,H.id);n=e}else if(a===o.zZ.signTransaction)n=await o.pQ.solana.signTransaction(t,H.id);else{if(a!==o.zZ.signAllTransactions)throw new Error("Unknown method");n=await o.pQ.solana.signAllTransactions(t,H.id)}(0,o.qD)({record_type:c.ee.PAGE_SIGN_CONFIRM_BUTTON_CLICK_SUCCESS})}catch(s){(0,o.qD)({record_type:c.ee.PAGE_SIGN_CONFIRM_BUTTON_CLICK_FAILURE}),50103!==(null==s?void 0:s.error_code)||null!=(e=null==S?void 0:S.security_account)&&e.has_set_payment_password?"Local Key not found"===(null==s?void 0:s.message)||"Master password decryption error"===(null==s?void 0:s.message)?y("account/master-password/verify"):b(s):(0,o.P9)().then((()=>{W()})).catch((e=>{var a;M(!1),I.error(null!=(a=e.message)?a:"Sign Error")}))}finally{M(!1)}n&&(a===o.zZ.signMessage&&C?_.emit("loginSuccess",{...S,authorization:{message:g.encode(t),signature:n}}):R(n))};(0,v.useEffect)((()=>{if(a===o.zZ.signMessage)O(N("sign.signature_message")),U(N("sign.signature_title"));else if(a===o.zZ.signAndSendTransaction){O(N("sign.send_transaction")),U(N("sign.approve_and").format((0,i.I)(H)));let e=t.serialize({requireAllSignatures:!1,verifySignatures:!1});j([g.encode(e)])}else if(a===o.zZ.signTransaction){O(N("sign.sign_transaction")),U(N("sign.sign_but"));let e=t.serialize({requireAllSignatures:!1,verifySignatures:!1});j([g.encode(e)])}else{if(a!==o.zZ.signAllTransactions)throw new Error("Unknown method");{O(N("sign.sign_transaction")),U(N("sign.sign_but"));let e=t.map((e=>g.encode(e.serialize({requireAllSignatures:!1,verifySignatures:!1}))));j(e)}}}),[t]),(0,v.useEffect)((()=>{o.pQ.solana.connect()}),[]);let j=e=>{o.pQ.solana.request({chainId:H.id,method:o.iP.enhancedDeserializeTransaction,params:e}).then((e=>{var a,t;L(e),V((async e=>{let a=await f.findAssociatedTokenAddress(o.pQ.solana.selectedAddress,e.mint);return e.associatedTokenAddress===a.toBase58()}),null==(a=null==e?void 0:e.estimatedChanges)?void 0:a.nfts).then((e=>{Z(e)})),V((async e=>{let a=await f.findAssociatedTokenAddress(o.pQ.solana.selectedAddress,e.mint);return e.associatedTokenAddress===a.toBase58()}),null==(t=null==e?void 0:e.estimatedChanges)?void 0:t.tokens).then((e=>{x(e)}))})).catch((a=>{var t;m.A.error({title:null!=(t=a.message)?t:"Deserialize Transaction Error",okCancel:!0,cancelText:N("common.cancel"),okText:N("common.retry"),wrapClassName:"auth-core-modal-error",getContainer:()=>A.rootBody,onOk:()=>{j(e)}})}))};return v.createElement("div",{className:"info-sign"},v.createElement("style",null,n.c),!F&&v.createElement("div",{className:"has-payment-password","data-telegram":(0,i.la)()},v.createElement("div",{className:"has-payment-password-icon"}),v.createElement("div",{className:"has-payment-password-tip"},N("account.waring_tip1")),v.createElement("div",{className:"has-payment-password-set",onClick:T},N("account.set"))),v.createElement("div",{className:"scroll-part"+(F?"":" no-password-tip")},v.createElement(n.d,{userInfo:S,transactionInfo:P}),v.createElement("div",{className:"info-request"},Q),v.createElement("div",{className:"info-title"},v.createElement("img",{src:(0,o.NO)(H),alt:""}),(0,i.I)(H)),v.createElement(h,{text:o.pQ.solana.selectedAddress,onCopy:()=>I.success(N("new.copied_to"))},v.createElement("div",{className:"info-address"},K,v.createElement("div",{className:"copy-icon"},v.createElement(n.a,null)))),v.createElement("div",{className:"info-des"},G),v.createElement("div",{className:"apart-line"}),a===o.zZ.signMessage&&(()=>{let e=(new TextDecoder).decode(t);return v.createElement("div",{className:"sign-message"},v.createElement("div",{className:"message"+(F?"":" no-password-tip")},v.createElement("div",{className:"pre-wrap personal-message"},e)))})(),a!==o.zZ.signMessage&&(()=>{var e;return v.createElement(d.A,{defaultActiveKey:"1",items:[{label:N("sign.details"),key:"1",children:v.createElement(v.Fragment,null,v.createElement("div",{className:"balance-change"},v.createElement("div",{className:"title"},N("sign.estimated_balance_change")),v.createElement("div",{className:"change-body"},null==(e=null==P?void 0:P.estimatedChanges)?void 0:e.sols.filter((e=>{var a,t;return e.address===(null==(t=null==(a=o.pQ)?void 0:a.solana)?void 0:t.selectedAddress)})).map(((e,a)=>v.createElement("div",{className:"change-title",key:"sol-change-".concat(a)},"SOL",v.createElement("div",{className:"change-val",style:e.lamportsChange<0?{color:"#ea4335"}:{}},e.lamportsChange<0?"":"+",(0,i.T)(e.lamportsChange,9))))),null==q?void 0:q.map(((e,a)=>v.createElement("div",{className:"change-title",key:"nft-change-".concat(a)},e.name?e.name:"Unknown NFT",v.createElement("div",{className:"change-val",style:e.amountChange<0?{color:"#ea4335"}:{}},e.amountChange<0?"":"+",e.amountChange)))),null==B?void 0:B.map(((e,a)=>v.createElement("div",{className:"change-title",key:"token-change-".concat(a)},e.name?e.name:"Unknown Token",v.createElement("div",{className:"change-val",style:e.amountChange<0?{color:"#ea4335"}:{}},e.amountChange<0?"":"+",(0,i.T)(e.amountChange,e.decimals))))))),v.createElement("div",{className:"net-fee solana"},v.createElement("div",{className:"title"},N("sign.network_fee"),P&&v.createElement("div",{className:"fee-val"},(0,i.T)(P.estimatedLamportsFee,9)," SOL"))))},{label:N("sign.data"),key:"2",children:v.createElement("div",null,null==P?void 0:P.instructions.map(((e,a)=>v.createElement("div",{className:"inner-instruction",key:"instruction-".concat(a)},v.createElement("div",{className:"inner-content"},v.createElement("div",{className:"content-item"},v.createElement("div",{className:"item"},v.createElement("div",{className:"item-0"},"#",a+1," - ",N("program.".concat(e.type))),v.createElement("div",{className:"item-1 mt10"},N("sign.program_id"),v.createElement("span",null,(0,i.N)(e.programId))),v.createElement("div",{className:"item-1 mt15"},N("sign.data"),v.createElement("span",null,(0,i.N)(e.data))))))))))}]})})()),v.createElement("div",{className:"btn-box"},v.createElement("div",null,v.createElement(u.A,{className:"btn-cancel",onClick:()=>{z||(C?_.emit("loginSuccess",S):R(void 0,i.a.userRejectedRequest()))}},N("common.cancel")),v.createElement(u.A,{className:"btn-approve",onClick:W,loading:z},N("common.confirm"))),v.createElement(r.a,null)))}}}]);
//# sourceMappingURL=1531.91b7589f.chunk.js.map